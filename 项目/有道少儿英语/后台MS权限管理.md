# 后台MS权限管理
## 数据库设计
数据库使用5张表，分别是 用户表、角色表、权限表、用户角色表、角色权限表（属性省略）
![title](https://raw.githubusercontent.com/pallcard/noteImg/master/noteImg/2020/03/08/Screen%20Shot%202019-06-25%20at%2011.42.16%20AM-1583637023859.png?token=AHBYBJ3GYFIXXCLZQADJBHK6MRRF6)

## 整体思路
1. 项目启动时读取所有接口，更新权限表
2. 修改登录拦截器，判断用户权限
3. 角色、权限接口

## 优化&问题
###问题：MS后端启动很慢

线上部署涉及集群环境，项目启动时，多个机器会调用权限初始化（更新权限表）接口，故很慢；为了只让一个机器进行权限表的更新，故使用了分布式锁+rediskey（5min过期key）
只用分布式锁：第一个机器拿到


###优化：添加操作日志
