# 垃圾收集

垃圾收集主要针对堆和方法区。程序计数器、虚拟机栈，本地方法栈属于线程私有，只存在于线程的生命周期内。

## 判断一个对象是否可以被回收
1. 引用计数法
    为对象添加一个引用计数器，对象增加一个引用时计数器+1，引用失效计数器-1，计时器为0时回收。
    问题：循环引用无法处理
2. 可达性分析
    通过GC Roots为起始点进行搜索，可达的对象是存活的，不可达的对象可被回收。
    GC Roots的选取：
    * 虚拟机栈的局部变量表所引用的对象
    * 本地方法栈中JNI中引用的对象
    * 方法区中类静态属性引用的对象
    * 方法去中常量引用的对象

## 方法区的回收 & finalize()

### 方法区的回收
方法区主要存放永久带对象，对方法区的回收主要是对常量池的回收和对类的卸载。
对类的卸载需满足一下条件：
* 该类所有**实例**已经被回收
* 该类ClassLoader已被回收
* 该类对应的Class对象未被引用

### finalize()

当一个对象可被回收时，如果需要执行该对象的 finalize() 方法，那么就有可能在该方法中让对象重新被引用，从而实现自救。自救只能进行一次，如果回收的对象之前调用了 finalize() 方法自救，后面回收时不会再调用该方法。

## 引用类型
1. 强引用
2. 软引用
3. 弱
